<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Relationship Wrapped - Final Stats</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        font-family: -apple-system, BlinkMacSystemFont, "San Francisco", Helvetica, Arial, sans-serif;
        background: #000;
        color: #fff;
        overflow: hidden;
        cursor: pointer;
        transition: opacity 2s ease, transform 2s ease;
    }

    /* --- Now Playing --- */
    #now-playing {
        position: fixed;
        top: 20px;
        left: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
        background: rgba(0,0,0,0.5);
        padding: 6px 12px;
        border-radius: 20px;
        font-weight: bold;
        z-index: 100;
    }

    #cd-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        animation: spin 3s linear infinite;
    }

    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    #song-title {
        font-size: 14px;
        white-space: nowrap;
    }

    /* --- Screen --- */
    .screen {
        width: 100vw;
        height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding-top: 120px;
        background: linear-gradient(-45deg, #000000, #111111, #0a0a0a, #1a1a1a);
        background-size: 400% 400%;
        animation: pulseBackground 12s ease infinite;
    }

    @keyframes pulseBackground {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    h1 {
        font-size: 60px;
        font-weight: bold;
        color: #d3f971;
        margin-bottom: 50px;
        text-align: center;
    }

    /* --- Pie Charts Container --- */
    .charts-container {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        gap: 80px;
        width: 90%;
        flex-wrap: wrap;
        margin-bottom: 50px;
    }

    .chart-box {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 20px;
        color: #fff;
        margin-bottom: 40px;
    }

    /* --- Pie chart --- */
    .pie-wrapper {
        position: relative;
        width: 200px;
        height: 200px;
    }

    .pie {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background: conic-gradient(#d3f971 0deg, #d3f971 0deg, #444 0deg 360deg);
        transition: background 1s ease-out;
    }

    .pie.full {
        background: conic-gradient(#d3f971 0deg, #d3f971 0deg, #444 0deg 360deg);
    }

    .pie-center {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 120px;
        height: 120px;
        background: #000;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        font-weight: bold;
        color: #fff;
        text-align: center;
        padding: 5px;
    }

    /* --- Legend --- */
    .legend {
        display: flex;
        flex-direction: column;
        font-size: 16px;
    }

    .legend-item {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
        gap: 10px;
    }

    .legend-color {
        width: 20px;
        height: 20px;
        border-radius: 4px;
    }
</style>
</head>
<body>

<!-- Now Playing -->
<div id="now-playing">
    <img src="CD_icon.svg" id="cd-icon" alt="CD">
    <div id="song-title">Now Playing: Twenty one pilots - Smithereens</div>
</div>

<audio id="bg-music" src="Twenty one pilots - Smithereens.mp3" loop></audio>

<div class="screen" id="screen">
    <h1>FINAL STATS!!!!</h1>

    <div class="charts-container" id="top-charts">
        <!-- Top row: Partial pies (comparison stats) -->
        <div class="chart-box">
            <div class="pie-wrapper"><div class="pie" id="pie1"></div></div>
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background:#d3f971;"></div> Beautiful but in yellow</div>
                <div class="legend-item"><div class="legend-color" style="background:#444;"></div> Beautiful</div>
            </div>
        </div>
        <div class="chart-box">
            <div class="pie-wrapper"><div class="pie" id="pie2"></div></div>
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background:#ee209c;"></div> Photos of bear</div>
                <div class="legend-item"><div class="legend-color" style="background:#444;"></div> Photos of loki</div>
            </div>
        </div>
        <div class="chart-box">
            <div class="pie-wrapper"><div class="pie" id="pie3"></div></div>
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background:#4b917d;"></div> Time I said I love you</div>
                <div class="legend-item"><div class="legend-color" style="background:#444;"></div> Time you said I love you</div>
            </div>
        </div>
    </div>

    <div class="charts-container" id="bottom-charts">
        <!-- Bottom full pies -->
        <div class="chart-box">
            <div class="pie-wrapper"><div class="pie full" id="pie4"></div></div>
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background:#d3f971;"></div> Photos of you</div>
                <div class="legend-item"><div class="legend-color" style="background:#444;"></div> Photos of me</div>
            </div>
        </div>
        <div class="chart-box">
            <div class="pie-wrapper"><div class="pie full" id="pie5"></div></div>
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background:#ee209c;"></div> Times not kissed.</div>
                <div class="legend-item"><div class="legend-color" style="background:#444;"></div> Times kissed.</div>
            </div>
        </div>
        <div class="chart-box">
            <div class="pie-wrapper"><div class="pie full" id="pie6"></div></div>
            <div class="legend">
                <div class="legend-item"><div class="legend-color" style="background:#4b917d;"></div> How much I love you</div>
                <div class="legend-item"><div class="legend-color" style="background:#444;"></div> How much you love me</div>
            </div>
        </div>
    </div>
</div>

<script>
const music = document.getElementById("bg-music");
const screen = document.getElementById("screen");

// --- Music fade functions ---
function fadeIn(audio, duration = 2000) {
    audio.volume = 0;
    audio.play();
    let step = 50;
    let increment = step / duration;
    let vol = 0;
    const fade = setInterval(() => {
        vol += increment;
        if (vol >= 1) { audio.volume = 0.5; clearInterval(fade); } 
        else audio.volume = vol;
    }, step);
}

function fadeOut(audio, duration = 2000, callback) {
    let step = 50;
    let decrement = step / duration;
    let vol = audio.volume;
    const fade = setInterval(() => {
        vol -= decrement;
        if (vol <= 0) { audio.volume = 0; audio.pause(); clearInterval(fade); if(callback) callback(); } 
        else audio.volume = vol;
    }, step);
}

// --- Start music ---
window.addEventListener('DOMContentLoaded', () => {
    fadeIn(music, 2000);
    animatePieCharts();
});

// --- Click anywhere â†’ fade out music AND screen/body, go to page6 ---
screen.addEventListener('click', () => {
    fadeOut(music, 2000, () => {
        window.location.href = "page6.html";
    });
    document.body.style.opacity = 0;
    document.body.style.transform = 'translateY(-50px)';
});

// --- Pie chart animation ---
function animatePieCharts() {
    // Top charts (partial fill)
    const topCharts = [
        { id: 'pie1', value: 25 },
        { id: 'pie2', value: 90 },
        { id: 'pie3', value: 59 }
    ];

    topCharts.forEach(chart => {
        let current = 0;
        const el = document.getElementById(chart.id);
        const interval = setInterval(() => {
            current++;
            el.style.background = `conic-gradient(
                #${el.id === 'pie2' ? 'ee209c' : el.id === 'pie3' ? '4b917d' : 'd3f971'} 0deg ${current*3.6}deg,
                #444 ${current*3.6}deg 360deg
            )`;
            if(current >= chart.value) clearInterval(interval);
        }, 15);
    });

    // Bottom charts (full classic pies)
    const bottomCharts = [
        { id: 'pie4', color:'#d3f971', value: 92 },
        { id: 'pie5', color:'#ee209c', value: 100 },
        { id: 'pie6', color:'#4b917d', value: 99 }
    ];

    bottomCharts.forEach(chart => {
        let current = 0;
        const el = document.getElementById(chart.id);
        const interval = setInterval(() => {
            current++;
            el.style.background = `conic-gradient(
                ${chart.color} 0deg ${current*3.6}deg,
                #444 ${current*3.6}deg 360deg
            )`;
            if(current >= chart.value) clearInterval(interval);
        }, 15);
    });
}
</script>

</body>
</html>
